---
date: 2025-11-27
---

## Announcements

# Text as Data

## Visualizing Literature

![](/images/vis1.png)

## Lexical Novelty {.smaller}

::::: columns 
::: {.column}
![](/images/vis2.png)
:::
::: {.column}
"Novels are full of new characters, new locations and new expressions. The discourse between characters involves new ideas being exchanged. We can get a hint of this by tracking the introduction of new terms in a novel. In the below visualizations (in which each column represents a chapter and each small block a paragraph of text), I maintain a variable which represents novelty. When a paragraph contains more than 25% new terms (i.e. words that have not been observed thus far) this variable is set at its maximum of 1. Otherwise, the variable decays. The variable is used to colour the paragraph with red being 1.0 and blue being 0. The result is that we can get an idea of the introduction of new ideas in novels."  - Matthew Hurst
:::
:::::


## Word Co-occurrence 

![](/images/vis3.png)

## Cross References

![](/images/vis4.png)

## Sentiment Analysis

![](/images/vis5.png)

## Mapping

![](/images/vis6.png)


## Visualizing Literature

- A novel is just a **long sequence of characters**.
- If we treat it as **data**, we can:
  - Count and visualize patterns,
  - Compare books or authors,
  - Build networks of characters and concepts.
- Today: turn a novel into **numbers and pictures**.

## What Can We Compute From a Book? {.activity}

If I give you the full text of a novel as a `.txt` file

  - What **questions** could we ask?
  - What **numbers** or **graphs** could we compute?

Ideas:

## The Text-as-Data Pipeline {.smaller}

**Data flow:**

1. **Load** the text from a file
2. **Tokenize**: split into words
3. **Preprocess**:
   - lowercase
   - remove punctuation
   - remove stopwords
   - use **lemmas**
4. **Count** frequencies
5. **Visualize** as a bar chart
6. **Interpret**: what do the counts tell us?

## Step 1: Getting the Text into Python

``` {pyodide}
import requests

url = "https://raw.githubusercontent.com/UBC-CS/cpsc203/main/data/ofk.txt"

resp = requests.get(url)
resp.raise_for_status()   # optional but good practice
text = resp.text          # this is your whole file as one big string

print(text[:500])  # peek at the first 500 characters
```


## Tokenizer

We want to analyze the data by word or by \_\_\_\_\_\_\_\_\_\_\_\_ or by \_\_\_\_\_\_\_\_\_\_\_\_ or by \_\_\_\_\_\_\_\_\_\_\_\_...  

We can separate the data (string) into any of these using a “tokenizer”


## Tokenization

\ 

Translate: “Astrology. The governess was always\ngetting muddled with her astrolabe, and when she got specially muddled she would take it out\nof the Wart by rapping his knuckles. She did not rap Kay's knuckles, because when Kay grew\nolder”

\ 

Into: ['Astrology.', 'The', 'governess', 'was', 'always', 'getting', 'muddled', 'with', 'her', 'astrolabe', ',', 'and', 'when', 'she', 'got', 'specially', 'muddled', 'she', 'would', 'take', 'it', 'out', 'of', 'the', 'Wart', 'by', 'rapping', 'his', 'knuckles.', 'She', 'did', 'not', 'rap', 'Kay', "'s", 'knuckles', ',', 'because', 'when', 'Kay', 'grew', 'older']


## Demo

::::: columns
::: {.column width=70%}
![](/images/tokens.png)
:::
::: {.column width=30%}

\ 

\ 

Thirty most common tokens in the mystery text.
:::
:::::

## Pre-processing

![](/images/freq1.png)

## A Feasible Sequence

<svg xmlns="http://www.w3.org/2000/svg"
     width="900" height="100" viewBox="0 0 900 100">
<style>
    .box {
      rx: 15;
      ry: 15;
      stroke: #5b4c8a;
      stroke-width: 2;
    }
    .box-light {
      fill: #e3d7ff;
    }
    .box-mid {
      fill: #c5b2ff;
    }
    .label {
      font-family: "Helvetica", "Arial", sans-serif;
      font-size: 18px;
      text-anchor: middle;
      dominant-baseline: middle;
      fill: #2b2147;
    }
  </style>
  <rect class="box box-light" x="40" y="20" width="160" height="60" />
  <text class="label" x="120" y="50">lower case</text>
  <rect class="box box-mid" x="240" y="20" width="160" height="60" />
  <text class="label" x="315" y="39">eliminate</text>
  <text class="label" x="315" y="61">punctuation</text>
  <rect class="box box-mid" x="440" y="20" width="160" height="60" />
  <text class="label" x="520" y="39">remove stop</text>
  <text class="label" x="520" y="61">words</text>
  <rect class="box box-mid" x="640" y="20" width="80" height="60" />
  <text class="label" x="680" y="50">lemma</text>
</svg>

::::: columns
::: {.column width=70%}
![](/images/lowercase.png)
:::
::: {.column width=30%}

Unify tally for “Valor” and “valor”.

\

Depending on task, may not want to do this.

:::
:::::

## A Feasible Sequence

<svg xmlns="http://www.w3.org/2000/svg"
     width="900" height="100" viewBox="0 0 900 100">
<style>
    .box {
      rx: 15;
      ry: 15;
      stroke: #5b4c8a;
      stroke-width: 2;
    }
    .box-light {
      fill: #e3d7ff;
    }
    .box-mid {
      fill: #c5b2ff;
    }
    .label {
      font-family: "Helvetica", "Arial", sans-serif;
      font-size: 18px;
      text-anchor: middle;
      dominant-baseline: middle;
      fill: #2b2147;
    }
  </style>
  <rect class="box box-mid" x="40" y="20" width="160" height="60" />
  <text class="label" x="120" y="50">lower case</text>
  <rect class="box box-light" x="240" y="20" width="160" height="60" />
  <text class="label" x="315" y="39">eliminate</text>
  <text class="label" x="315" y="61">punctuation</text>
  <rect class="box box-mid" x="440" y="20" width="160" height="60" />
  <text class="label" x="520" y="39">remove stop</text>
  <text class="label" x="520" y="61">words</text>
  <rect class="box box-mid" x="640" y="20" width="80" height="60" />
  <text class="label" x="680" y="50">lemma</text>
</svg>

::::: columns
::: {.column width=70%}
![](/images/minuspunctuation.png)
:::
::: {.column width=30%}

Tokenizer leaves periods at end of sentences: "father."

\ 

Amazingly, it works fine for “Dr.”, “$3.50”, “!”

:::
:::::

## A Feasible Sequence {.smaller}

<svg xmlns="http://www.w3.org/2000/svg"
     width="900" height="100" viewBox="0 0 900 100">
<style>
    .box {
      rx: 15;
      ry: 15;
      stroke: #5b4c8a;
      stroke-width: 2;
    }
    .box-light {
      fill: #e3d7ff;
    }
    .box-mid {
      fill: #c5b2ff;
    }
    .label {
      font-family: "Helvetica", "Arial", sans-serif;
      font-size: 18px;
      text-anchor: middle;
      dominant-baseline: middle;
      fill: #2b2147;
    }
  </style>
  <rect class="box box-mid" x="40" y="20" width="160" height="60" />
  <text class="label" x="120" y="50">lower case</text>
  <rect class="box box-mid" x="240" y="20" width="160" height="60" />
  <text class="label" x="315" y="39">eliminate</text>
  <text class="label" x="315" y="61">punctuation</text>
  <rect class="box box-light" x="440" y="20" width="160" height="60" />
  <text class="label" x="520" y="39">remove stop</text>
  <text class="label" x="520" y="61">words</text>
  <rect class="box box-mid" x="640" y="20" width="80" height="60" />
  <text class="label" x="680" y="50">lemma</text>
</svg>

::::: columns
::: {.column width=70%}
![](/images/minusstopwords.png)
:::
::: {.column width=30%}

List of common, unhelpful words compiled by `spacy` from large corpora.  We keep words that aren’t in that list.

\ 

More sophisticated approach is called tf-idf.

:::
:::::

## A Feasible Sequence

<svg xmlns="http://www.w3.org/2000/svg"
     width="900" height="100" viewBox="0 0 900 100">
<style>
    .box {
      rx: 15;
      ry: 15;
      stroke: #5b4c8a;
      stroke-width: 2;
    }
    .box-light {
      fill: #e3d7ff;
    }
    .box-mid {
      fill: #c5b2ff;
    }
    .label {
      font-family: "Helvetica", "Arial", sans-serif;
      font-size: 18px;
      text-anchor: middle;
      dominant-baseline: middle;
      fill: #2b2147;
    }
  </style>
  <rect class="box box-mid" x="40" y="20" width="160" height="60" />
  <text class="label" x="120" y="50">lower case</text>
  <rect class="box box-mid" x="240" y="20" width="160" height="60" />
  <text class="label" x="315" y="39">eliminate</text>
  <text class="label" x="315" y="61">punctuation</text>
  <rect class="box box-mid" x="440" y="20" width="160" height="60" />
  <text class="label" x="520" y="39">remove stop</text>
  <text class="label" x="520" y="61">words</text>
  <rect class="box box-light" x="640" y="20" width="80" height="60" />
  <text class="label" x="680" y="50">lemma</text>
</svg>

::::: columns
::: {.column width=70%}
![](/images/lemmas.png)
:::
::: {.column width=30%}

goes -> go
running -> run
eaten -> eat

:::
:::::

## Curious?

::::: columns
::: {.column}
![](/images/minusstopwords90.png)
:::
::: {.column}
![](/images/lemmas90.png)
:::
:::::

## Demo {.activity}

[PrairieLearn Activity](https://us.prairielearn.com/pl/course_instance/193300/assessment/2618732)



